# Thesis


# Cantilever

## Dataset
Run the following scripts to generate datasets stored in `.txt` files and ANSYS APDL code stored in `.lgw` files that are used to automate FEA simulations:
* `generate_train_dataset.py` generates:
    * `samples_train.txt`
    * `ansys_script_train.lgw`
* `generate_validation_dataset.py` generates:
    * `samples_validation.txt`
    * `ansys_script_validation.lgw`
* `generate_test_dataset.py` generates:
    * `samples_test.txt`
    * `ansys_script_test.lgw`

The ANSYS APDL scripts are generated by filling in placeholder text in the template script `ansys_template.lgw`.

Place the `.txt` files generated by ANSYS in the respective folders:
* `Train Labels`
* `Validation Labels`
* `Test Labels`

### Stratified Sampling

### ANSYS APDL
To run a script in ANSYS APDL, click File > Read Input from... > [Select the `.lgw` file].

## Training and Testing
Run `main.py` to train and test the model. Set the number of epochs and learning rate manually. After training, output images generated by the model and the corresponding label images are saved in the current folder. Plots showing the loss history and evaluation metrics are displayed.
* Input images are generated at runtime and are not saved as files.
* Labels generated from ANSYS must be located in the respective folder. Images are generated from this data at runtime.
* Model parameters are saved periodically as `model.pth`.
* Training can be continued where it left off if an existing `model.pth` exists. When prompted, confirm this by entering "y" or "n". To train from scratch, remove `model.pth` from the folder before running.
    * The model being trained must match the model stored in `model.pth`.


## Google Colab

### Uploading Files
1. Upload all required `.py` files other than `main.py` to the current directory: `/content/`. These files need to be uploaded each time the session resets.
2. Uploaded all other required files (`.txt`, etc.) to a folder of choice in Google Drive. This folder is specified in the code as: `drive/My Drive/<FOLDER>`. Click "Mount Drive" in the sidebar to make files from Google Drive available. This creates a folder called `drive` in the directory `/content/`.

### Using GPU
To use GPU, click Runtime > Change runtime type.